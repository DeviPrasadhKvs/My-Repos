<!DOCTYPE html>
<html>
<head>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <script>
        function chat(route){
            $.ajax({
        url:'http://localhost:4000/chat/'+route,
        type: "GET",
        success: function (d){
         console.log(d);
         var cont = document.getElementById('container')
         var messagecont = document.getElementById('messages')
         if(d.status === 1){
            d.data.forEach(element => {
             if(element.input){
                var ele = document.createElement('input')
                ele.placeholder = element.message
                ele.id = 'toSInput'
                cont.append(ele)

                var but = document.createElement('button')
                but.innerHTML = 'Send'
                but.onclick = ()=>{
                 chat(element.code+'*'+( document.getElementById('toSInput')).value)
                 cont.innerHTML = ''
               }
             cont.append(but)
             }else{
                var ele = document.createElement('button')
                ele.innerHTML = element.shortmessage
                ele.onclick = ()=>{
                  var mes = document.createElement('p')
                 mes.innerHTML = element.message
                 messagecont.append(mes)
                 cont.innerHTML = ''
                 chat(element.code)
               }
             cont.append(ele)
             }
        });
         }
         else if(d.status === 2){
            var mes = document.createElement('p')
                 mes.innerHTML = d.data
                 messagecont.append(mes)
         }
        },
        error: function (data) {
               console.log(data)
        }
    });
        }

        function init(){
               chat('init');
        }
    </script>
     
    
</head>
<body onload="init()">
    <center><br><br>

        <h2>Bot</h2><br><br>
    </center>
    <div id="messages"></div>
    <div id="container"></div>
</body>

</html>